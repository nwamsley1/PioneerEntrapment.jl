using Pkg; Pkg.instantiate()
using PioneerEntrapment

# Paths
library = "/Users/nathanwamsley/Data/SPEC_LIBS/entrapment_08-20-2025/altimeter_yeast_len7o40_ch2o3_mc1_MTACAstral_Aug302025_entrapR1.poin/altimeter_yeast_len7o40_ch2o3_mc1_MTACAstral_Aug302025_entrapR1.poin.poin"

rep1 = "/Users/nathanwamsley/Data/MS_DATA/MTAC_Y_Astral/YEAST_3MIN/MTAC_Y_entrapR1_feature-fix-mbr_D_08-30-2025/precursors_long.arrow"
rep2 = "/Users/nathanwamsley/Data/MS_DATA/MTAC_Y_Astral/YEAST_3MIN/MTAC_Y_entrapR1_feature-fix-mbr_C_08-30-2025/precursors_long.arrow"

out = "./efdr_compare"

replicates = [
    (precursor_results_path=rep1, library_precursors_path=library, label="D_08-30-2025"),
    (precursor_results_path=rep2, library_precursors_path=library, label="C_08-30-2025"),
]

run_efdr_replicate_plots(replicates;
    output_dir=out,
    r_lib=1.0,
    paired_stride=10,          # sampling stride for paired EFDR
    plot_formats=[:png, :pdf],
    verbose=true,
)

println("Saved combined replicate plots to: ", out)

