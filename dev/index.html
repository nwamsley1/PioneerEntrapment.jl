<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · PioneerEntrapment.jl</title><meta name="title" content="Home · PioneerEntrapment.jl"/><meta property="og:title" content="Home · PioneerEntrapment.jl"/><meta property="twitter:title" content="Home · PioneerEntrapment.jl"/><meta name="description" content="Documentation for PioneerEntrapment.jl."/><meta property="og:description" content="Documentation for PioneerEntrapment.jl."/><meta property="twitter:description" content="Documentation for PioneerEntrapment.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>PioneerEntrapment.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Julia-REPL-(quick-start)"><span>Julia REPL (quick start)</span></a></li><li><a class="tocitem" href="#CLI-(single-run)"><span>CLI (single run)</span></a></li><li><a class="tocitem" href="#API-Reference"><span>API Reference</span></a></li><li><a class="tocitem" href="#Example:-Julia-REPL-on-local-data"><span>Example: Julia REPL on local data</span></a></li><li><a class="tocitem" href="#Live-Reload-with-Revise"><span>Live Reload with Revise</span></a></li><li><a class="tocitem" href="#Multi-run-comparison-(replicates)"><span>Multi-run comparison (replicates)</span></a></li><li><a class="tocitem" href="#Folder-convenience-(both-precursor-and-protein)"><span>Folder convenience (both precursor and protein)</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/nwamsley1/PioneerEntrapment.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/nwamsley1/PioneerEntrapment.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="PioneerEntrapment.jl"><a class="docs-heading-anchor" href="#PioneerEntrapment.jl">PioneerEntrapment.jl</a><a id="PioneerEntrapment.jl-1"></a><a class="docs-heading-anchor-permalink" href="#PioneerEntrapment.jl" title="Permalink"></a></h1><p>Entrapment-based empirical FDR analysis for DIA proteomics.</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><pre><code class="language-julia hljs">] add https://github.com/nwamsley1/PioneerEntrapment.jl</code></pre><h2 id="Julia-REPL-(quick-start)"><a class="docs-heading-anchor" href="#Julia-REPL-(quick-start)">Julia REPL (quick start)</a><a id="Julia-REPL-(quick-start)-1"></a><a class="docs-heading-anchor-permalink" href="#Julia-REPL-(quick-start)" title="Permalink"></a></h2><pre><code class="language-julia hljs">using PioneerEntrapment
run_efdr_analysis(&quot;precursors.arrow&quot;, &quot;library.arrow&quot;; output_dir=&quot;out&quot;)
run_protein_efdr_analysis(&quot;proteins.arrow&quot;; output_dir=&quot;out&quot;)
run_both_analyses(; precursor_results_path=&quot;precursors.arrow&quot;, library_precursors_path=&quot;library.arrow&quot;, protein_results_path=&quot;proteins.arrow&quot;, output_dir=&quot;out&quot;)</code></pre><h2 id="CLI-(single-run)"><a class="docs-heading-anchor" href="#CLI-(single-run)">CLI (single run)</a><a id="CLI-(single-run)-1"></a><a class="docs-heading-anchor-permalink" href="#CLI-(single-run)" title="Permalink"></a></h2><pre><code class="language-bash hljs">pioneer-entrapment --mode precursor --precursor-results prec.arrow --library lib.arrow --outdir out
pioneer-entrapment --mode protein --protein-results protein.arrow --outdir out
pioneer-entrapment --mode both --precursor-results prec.arrow --library lib.arrow --protein-results protein.arrow --outdir out</code></pre><h2 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h2><ul><li><code>run_efdr_analysis</code></li><li><code>run_protein_efdr_analysis</code></li><li><code>run_both_analyses</code></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PioneerEntrapment._load_table-Tuple{AbstractString}" href="#PioneerEntrapment._load_table-Tuple{AbstractString}"><code>PioneerEntrapment._load_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Load a tabular file into a DataFrame. Supports Arrow/Feather (<code>.arrow</code>, <code>.feather</code>) and delimited text (<code>.csv</code>, <code>.tsv</code>, <code>.txt</code>). Also accepts a directory path (e.g., a <code>.poin</code> folder) and will locate a suitable table inside, preferring <code>precursors_table.arrow</code>, then any <code>.arrow</code>/<code>.feather</code>, then <code>.tsv</code>/<code>.csv</code>. Falls back to trying Arrow, then CSV regardless of extension.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nwamsley1/PioneerEntrapment.jl/blob/88dcf85b738e96de460f182d4c87923525dfb8d3/src/api.jl#L6-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PioneerEntrapment.add_entrap_pair_ids!-Tuple{DataFrames.DataFrame, DataFrames.DataFrame}" href="#PioneerEntrapment.add_entrap_pair_ids!-Tuple{DataFrames.DataFrame, DataFrames.DataFrame}"><code>PioneerEntrapment.add_entrap_pair_ids!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_entrap_pair_ids!(prec_results::DataFrame, library_precursors::DataFrame)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nwamsley1/PioneerEntrapment.jl/blob/88dcf85b738e96de460f182d4c87923525dfb8d3/src/core/entrapment_pairing.jl#L52-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PioneerEntrapment.add_original_target_scores!-Tuple{DataFrames.DataFrame, DataFrames.DataFrame}" href="#PioneerEntrapment.add_original_target_scores!-Tuple{DataFrames.DataFrame, DataFrames.DataFrame}"><code>PioneerEntrapment.add_original_target_scores!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_original_target_scores!(prec_results::DataFrame, library_precursors::DataFrame; score_col=:score)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nwamsley1/PioneerEntrapment.jl/blob/88dcf85b738e96de460f182d4c87923525dfb8d3/src/core/scoring.jl#L25-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PioneerEntrapment.assign_entrapment_pairs!-Tuple{DataFrames.DataFrame}" href="#PioneerEntrapment.assign_entrapment_pairs!-Tuple{DataFrames.DataFrame}"><code>PioneerEntrapment.assign_entrapment_pairs!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assign_entrapment_pairs!(df::DataFrame)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nwamsley1/PioneerEntrapment.jl/blob/88dcf85b738e96de460f182d4c87923525dfb8d3/src/core/entrapment_pairing.jl#L14-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PioneerEntrapment.calculate_efdr-Tuple{CombinedEFDR}" href="#PioneerEntrapment.calculate_efdr-Tuple{CombinedEFDR}"><code>PioneerEntrapment.calculate_efdr</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_efdr(method::EFDRMethod)</code></pre><p>Calculate empirical FDR using the data stored in the method struct.</p><p>Methods:</p><ul><li>CombinedEFDR: Standard combined empirical FDR calculation</li><li>PairedEFDR: Paired empirical FDR that considers score relationships</li></ul><p>Returns a vector of EFDR values aligned to the input order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nwamsley1/PioneerEntrapment.jl/blob/88dcf85b738e96de460f182d4c87923525dfb8d3/src/core/efdr_methods.jl#L41-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PioneerEntrapment.create_global_results_df-Tuple{DataFrames.DataFrame}" href="#PioneerEntrapment.create_global_results_df-Tuple{DataFrames.DataFrame}"><code>PioneerEntrapment.create_global_results_df</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_global_results_df(prec_results::DataFrame; score_col::Symbol=:global_prob)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nwamsley1/PioneerEntrapment.jl/blob/88dcf85b738e96de460f182d4c87923525dfb8d3/src/core/scoring.jl#L87-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PioneerEntrapment.generate_markdown_report-Tuple{DataFrames.DataFrame, DataFrames.DataFrame, Dict, Dict, Vector{Tuple{Symbol, Symbol}}, Vector, Int64, String, String}" href="#PioneerEntrapment.generate_markdown_report-Tuple{DataFrames.DataFrame, DataFrames.DataFrame, Dict, Dict, Vector{Tuple{Symbol, Symbol}}, Vector, Int64, String, String}"><code>PioneerEntrapment.generate_markdown_report</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_markdown_report(prec_results, library_precursors, comparison_results,
                       calibration_results, score_qval_pairs, method_types,
                       original_rows, output_dir, output_path)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nwamsley1/PioneerEntrapment.jl/blob/88dcf85b738e96de460f182d4c87923525dfb8d3/src/api.jl#L477-L481">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PioneerEntrapment.getModKey-Tuple{AbstractString}" href="#PioneerEntrapment.getModKey-Tuple{AbstractString}"><code>PioneerEntrapment.getModKey</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getModKey(mod_string::AbstractString)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nwamsley1/PioneerEntrapment.jl/blob/88dcf85b738e96de460f182d4c87923525dfb8d3/src/core/entrapment_pairing.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PioneerEntrapment.get_complement_score-Tuple{DataFrames.DataFrame, Int64}" href="#PioneerEntrapment.get_complement_score-Tuple{DataFrames.DataFrame, Int64}"><code>PioneerEntrapment.get_complement_score</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_complement_score(prec_results::DataFrame, row_idx::Int; score_col=:score)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nwamsley1/PioneerEntrapment.jl/blob/88dcf85b738e96de460f182d4c87923525dfb8d3/src/core/scoring.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PioneerEntrapment.plot_efdr_comparison_replicates-Tuple{Vector{DataFrames.DataFrame}, Symbol, Symbol}" href="#PioneerEntrapment.plot_efdr_comparison_replicates-Tuple{Vector{DataFrames.DataFrame}, Symbol, Symbol}"><code>PioneerEntrapment.plot_efdr_comparison_replicates</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Plot EFDR comparison across multiple replicate DataFrames on a single plot. Colors are per method; linestyles per replicate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nwamsley1/PioneerEntrapment.jl/blob/88dcf85b738e96de460f182d4c87923525dfb8d3/src/plotting/efdr_plots.jl#L113-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PioneerEntrapment.run_both_analyses-Tuple{}" href="#PioneerEntrapment.run_both_analyses-Tuple{}"><code>PioneerEntrapment.run_both_analyses</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_both_analyses(; precursor_results_path::AbstractString,
                    library_precursors_path::AbstractString,
                    protein_results_path::AbstractString,
                    output_dir::AbstractString = &quot;efdr_out&quot;,
                    r_lib::Float64 = 1.0,
                    plot_formats::Vector{Symbol} = [:png, :pdf],
                    verbose::Bool = true)</code></pre><p>Run both the precursor-level and protein-level analyses. Returns a NamedTuple with both results, writing outputs into <code>output_dir/precursor</code> and <code>output_dir/protein</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nwamsley1/PioneerEntrapment.jl/blob/88dcf85b738e96de460f182d4c87923525dfb8d3/src/api.jl#L716-L727">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PioneerEntrapment.run_efdr_analysis-Tuple{String, String}" href="#PioneerEntrapment.run_efdr_analysis-Tuple{String, String}"><code>PioneerEntrapment.run_efdr_analysis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_efdr_analysis(prec_results_path::String, library_precursors_path::String;
                  output_dir::String=&quot;efdr_out&quot;,
                  method_types=[CombinedEFDR, PairedEFDR],
                  score_qval_pairs=[(:global_prob, :global_qval), (:prec_prob, :qval)],
                  r_lib::Float64=1.0,
                  plot_formats=[:png, :pdf],
                  verbose::Bool=true)</code></pre><p>Run empirical FDR analysis on precursor-level data with entrapment sequences. Accepts Arrow/CSV inputs for convenience.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nwamsley1/PioneerEntrapment.jl/blob/88dcf85b738e96de460f182d4c87923525dfb8d3/src/api.jl#L276-L287">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PioneerEntrapment.run_efdr_plots-Tuple{String, String}" href="#PioneerEntrapment.run_efdr_plots-Tuple{String, String}"><code>PioneerEntrapment.run_efdr_plots</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_efdr_plots(results_dir::String, library_path::String; output_dir=joinpath(results_dir, &quot;efdr_out&quot;), r_lib=1.0, paired_stride=5, plot_formats=[:png,:pdf], verbose=true)</code></pre><p>Convenience entry point that looks for standard filenames in <code>results_dir</code>:</p><ul><li>precursors_long.arrow (or .tsv) for precursor-level</li><li>protein<em>groups</em>long.arrow (or .tsv) for protein-level</li></ul><p>Runs the appropriate analyses, writing outputs into <code>output_dir</code> (or subfolders if both).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nwamsley1/PioneerEntrapment.jl/blob/88dcf85b738e96de460f182d4c87923525dfb8d3/src/api.jl#L75-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PioneerEntrapment.run_efdr_replicate_plots-Tuple{Vector}" href="#PioneerEntrapment.run_efdr_replicate_plots-Tuple{Vector}"><code>PioneerEntrapment.run_efdr_replicate_plots</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_efdr_replicate_plots(replicates; output_dir=&quot;efdr_out&quot;, score_qval_pairs=[(:global_prob, :global_qval), (:prec_prob, :qval)], r_lib=1.0, paired_stride=5, plot_formats=[:png,:pdf], verbose=true)</code></pre><p>Compute EFDR for multiple (precursor<em>results</em>path, library<em>precursors</em>path) replicates and plot on shared figures.</p><p><code>replicates</code> is a Vector of NamedTuples with fields:</p><ul><li><code>precursor_results_path::String</code></li><li><code>library_precursors_path::String</code></li><li><code>label::String</code> (optional, used in plot legend)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nwamsley1/PioneerEntrapment.jl/blob/88dcf85b738e96de460f182d4c87923525dfb8d3/src/api.jl#L121-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PioneerEntrapment.run_protein_efdr_analysis-Tuple{String}" href="#PioneerEntrapment.run_protein_efdr_analysis-Tuple{String}"><code>PioneerEntrapment.run_protein_efdr_analysis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_protein_efdr_analysis(protein_results_path::String;
                          output_dir::String=&quot;efdr_out&quot;,
                          method_types=[CombinedEFDR, PairedEFDR],
                          score_qval_pairs=[(:global_pg_score, :global_qval), (:pg_score, :qval)],
                          r_lib::Float64=1.0,
                          plot_formats=[:png, :pdf],
                          verbose::Bool=true)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nwamsley1/PioneerEntrapment.jl/blob/88dcf85b738e96de460f182d4c87923525dfb8d3/src/api.jl#L528-L536">source</a></section></article><h2 id="Example:-Julia-REPL-on-local-data"><a class="docs-heading-anchor" href="#Example:-Julia-REPL-on-local-data">Example: Julia REPL on local data</a><a id="Example:-Julia-REPL-on-local-data-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Julia-REPL-on-local-data" title="Permalink"></a></h2><p>Run EFDR from a Julia REPL using a .poin library directory (auto-detects <code>precursors_table.arrow</code>) and a results folder with <code>precursors_long.arrow</code>.</p><pre><code class="language-bash hljs">cd /Users/nathanwamsley/Projects/PioneerEntrapment.jl
julia --project=. -q</code></pre><pre><code class="language-julia hljs">using Pkg; Pkg.instantiate()
using PioneerEntrapment

library = &quot;/Users/nathanwamsley/Data/SPEC_LIBS/entrapment_08-20-2025/altimeter_yeast_len7o40_ch2o3_mc1_MTACAstral_Aug302025_entrapR1.poin/altimeter_yeast_len7o40_ch2o3_mc1_MTACAstral_Aug302025_entrapR1.poin.poin&quot;
precursors = &quot;/Users/nathanwamsley/Data/MS_DATA/MTAC_Y_Astral/YEAST_3MIN/MTAC_Y_entrapR1_feature-fix-mbr_D_08-30-2025/precursors_long.arrow&quot;
# If TSV instead, use:
# precursors = &quot;/Users/nathanwamsley/Data/MS_DATA/MTAC_Y_Astral/YEAST_3MIN/MTAC_Y_entrapR1_feature-fix-mbr_D_08-30-2025/precursors_long.tsv&quot;
out = &quot;/Users/nathanwamsley/Data/MS_DATA/MTAC_Y_Astral/YEAST_3MIN/MTAC_Y_entrapR1_feature-fix-mbr_D_08-30-2025/efdr_out&quot;

run_efdr_analysis(precursors, library;
    output_dir=out,
    r_lib=1.0,
    paired_stride=10,      # sampling stride for paired EFDR
    plot_formats=[:png, :pdf],
    verbose=true,
)</code></pre><p>Notes</p><ul><li>Passing the library as the <code>.poin.poin</code> directory is supported; the loader resolves <code>precursors_table.arrow</code> internally.</li><li>Prefer <code>precursors_long.arrow</code> when available; <code>.tsv</code> also works.</li></ul><h2 id="Live-Reload-with-Revise"><a class="docs-heading-anchor" href="#Live-Reload-with-Revise">Live Reload with Revise</a><a id="Live-Reload-with-Revise-1"></a><a class="docs-heading-anchor-permalink" href="#Live-Reload-with-Revise" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Pkg; Pkg.add(&quot;Revise&quot;)
using Revise
using PioneerEntrapment

Revise.includet(&quot;scripts/replicate_plot_example.txt&quot;)

# after edits in src/, just call again
Revise.includet(&quot;scripts/replicate_plot_example.txt&quot;)</code></pre><h2 id="Multi-run-comparison-(replicates)"><a class="docs-heading-anchor" href="#Multi-run-comparison-(replicates)">Multi-run comparison (replicates)</a><a id="Multi-run-comparison-(replicates)-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-run-comparison-(replicates)" title="Permalink"></a></h2><p>Plot EFDR from multiple runs in a single figure (one color per method, solid lines per replicate).</p><pre><code class="language-julia hljs">using PioneerEntrapment

library = &quot;/path/to/library/.poin/.poin&quot;
rep1 = &quot;/path/to/run1/precursors_long.arrow&quot;
rep2 = &quot;/path/to/run2/precursors_long.arrow&quot;

replicates = [
  (precursor_results_path=rep1, library_precursors_path=library, label=&quot;run1&quot;),
  (precursor_results_path=rep2, library_precursors_path=library, label=&quot;run2&quot;),
]

run_efdr_replicate_plots(replicates;
  output_dir=&quot;./efdr_compare&quot;,
  r_lib=1.0,
  paired_stride=10,
  plot_formats=[:png, :pdf],
  verbose=true,
)</code></pre><p>See the output directory for files named like <code>efdr_comparison_replicates_global_prob.png</code>.</p><h3 id="CLI-via-config"><a class="docs-heading-anchor" href="#CLI-via-config">CLI via config</a><a id="CLI-via-config-1"></a><a class="docs-heading-anchor-permalink" href="#CLI-via-config" title="Permalink"></a></h3><pre><code class="language-bash hljs"># JSON
bin/pioneer-entrapment --mode replicates \
  --replicates-config scripts/replicates_example.json \
  --outdir ./efdr_compare --paired-step 10

# YAML (requires YAML.jl)
bin/pioneer-entrapment --mode replicates \
  --replicates-config scripts/replicates_example.yaml \
  --outdir ./efdr_compare --paired-step 10</code></pre><p>JSON expects an array of objects. YAML expects a top-level <code>replicates:</code> list with objects containing <code>precursor_results_path</code>, <code>library_precursors_path</code>, and optional <code>label</code>.</p><h3 id="CLI-(replicates)-with-TOML-config"><a class="docs-heading-anchor" href="#CLI-(replicates)-with-TOML-config">CLI (replicates) with TOML config</a><a id="CLI-(replicates)-with-TOML-config-1"></a><a class="docs-heading-anchor-permalink" href="#CLI-(replicates)-with-TOML-config" title="Permalink"></a></h3><pre><code class="language-bash hljs">JULIA_PROJECT=. bin/pioneer-entrapment --mode replicates \
  --replicates-config scripts/replicates_example.toml \
  --outdir ./efdr_compare --paired-step 10 --plot-formats png,pdf</code></pre><h2 id="Folder-convenience-(both-precursor-and-protein)"><a class="docs-heading-anchor" href="#Folder-convenience-(both-precursor-and-protein)">Folder convenience (both precursor and protein)</a><a id="Folder-convenience-(both-precursor-and-protein)-1"></a><a class="docs-heading-anchor-permalink" href="#Folder-convenience-(both-precursor-and-protein)" title="Permalink"></a></h2><p>Analyze a results folder with standard filenames (precursors<em>long.arrow and/or protein</em>groups_long.arrow):</p><pre><code class="language-julia hljs">using PioneerEntrapment
run_efdr_plots(&quot;/path/to/results&quot;, &quot;/path/to/library/.poin/.poin&quot;;
  output_dir=joinpath(&quot;/path/to/results&quot;, &quot;efdr_out&quot;),
  paired_stride=10,
  plot_formats=[:png, :pdf],
  verbose=true,
)</code></pre><p>\n+## Vector-friendly PDF output \n+- Plots.jl + GR: text set to be editable (<code>GR.setcharquality(0)</code>).\n+- Default font is Helvetica; override with <code>using Plots; Plots.default(fontfamily=\&quot;Arial\&quot;)</code> or pass <code>fontfamily</code> to plot calls.\n+- Include <code>:pdf</code> in <code>plot_formats</code> to save vector PDFs.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 3 September 2025 21:01">Wednesday 3 September 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
